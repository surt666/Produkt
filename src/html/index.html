<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="jquery-1.6.2.js"></script>          
    <script type="text/javascript">                                         
     $(function() {
       $('.error').hide();  
       $.ajax({        
         url: "http://localhost:8080/produkt/findalle/services",
         dataType: "jsonp",
         success: function(res) {
           var optionss = '';
           for (var i = 0; i < res.length; i++) {
             optionss += '<option value="' + res[i].id + '">' + res[i].navn + '</option>';
           }
           $("select#services").html(optionss);
         },
         error: function(xhr, ao, te) {
           alert("FUCK1 " + xhr.status + " " + xhr.message);
         }
       });
       $.ajax({        
         url: "http://localhost:8080/produkt/findalle/hardware",
         dataType: "jsonp",
         success: function(res) {
           var optionshw = '';
           for (var i = 0; i < res.length; i++) {
             optionshw += '<option value="' + res[i].id + '">' + res[i].navn + '</option>';
           }
           $("select#hardware").html(optionshw);
         },
         error: function(xhr, ao, te) {
           alert("FUCK2 " + xhr.status + " " + xhr.message);
         }
       });
       $('#submit_p').click(function() {
         var varenr = $("input#varenr").val(); 
         if (varenr == "") {  
           $("label#varenr_error").show();  
           $("input#varenr").focus();  
           return false;  
         }  
         var navn = $("input#navn").val(); 
         if (navn == "") {  
           $("label#navn_error").show();  
           $("input#navn").focus();  
           return false;  
         }  
         var services = $("select#services").val();
         var hardware = $("select#hardware").val();
         var datamap = {varenr: varenr, navn: navn, services: services, hardware: hardware};
         //alert (JSON.stringify(datamap));return false;
         $.ajax({ 
          accepts: "application/json",        
          cache: false,
          type: "POST",
          url: "http://localhost:8080/produkt/opret/produkt",
          contentType: "text/plain", 
          data: JSON.stringify(datamap),
          //processData: false,         
          success: function(res) {
            alert("OK " + res);
          },
          error: function(xhr, ts, te) {
            alert("FUCK " + xhr.status + " " + xhr.message + " " + ts + " " + te);
          }
        });
        return false;
       });
     });
    </script>                   
  </head>
  <body>
    <h1>Produkter</h1>
    <div id="form1">
      <form action="" id="produkt">
        <fieldset>
          <p><label for="varenr">Varenr:</label>
          <input type="text" id="varenr" />
          <label class="error" for="varenr" id="varenr_error">This field is required.</label></p>  
          <p><label for="navn">Navn:</label>
          <input type="text" id="navn" />
          <label class="error" for="navn" id="navn_error">This field is required.</label></p>
          <p><label for="hardware">Hardware:</label>
          <select id="hardware" name="hardware" multiple="multiple"></select> 
          <label for="services">Services:</label>
          <select id="services" name="services" multiple="multiple"></select></p>          
          <p><input type="submit" id="submit_p" value="Opret" /></p>
        </fieldset>
      </form>
    </div>
  </body>
</html>
